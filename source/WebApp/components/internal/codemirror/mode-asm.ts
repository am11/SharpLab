// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE
import CodeMirror from 'codemirror';

// the following line is generated by '#scripts/update-mode-asm/index.js'
const generatedRegex = new RegExp(/(?:a(?:d(?:c(?:|x)|d(?:|p(?:d|s)|s(?:d|s|ubp(?:d|s))|4s)|ox)|a[adms]|es(?:dec(?:|last)|enc(?:|last)|imc|keygenassist)|lign|nd(?:|n(?:|p(?:d|s))|p(?:d|s))|rpl)|b(?:b(?:0_reset|1_reset)|l(?:c(?:i(?:|c)|fill|msk|s)|s(?:i(?:|c)|fill|msk|r)|end(?:p(?:d|s)|vp(?:d|s)))|r(?:kem|oadcast(?:s(?:d|s)|f128|i128))|s(?:f|r|wap)|t(?:|[crs])|extr|nd(?:c(?:l|n|u)|m(?:k|ov)|ldx|stx)|ound|zhi)|c(?:b(?:tw|w)|l(?:t(?:d|s)|[cdi]|ac|flush(?:|opt)|gi|r1|wb|zero)|m(?:p(?:|l(?:e(?:p(?:d|s)|s(?:d|s))|t(?:p(?:d|s)|s(?:d|s)))|n(?:l(?:e(?:p(?:d|s)|s(?:d|s))|t(?:p(?:d|s)|s(?:d|s)))|eq(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:|[bdw]|l|q|s)|4s|eq(?:p(?:d|s)|s(?:d|s))|ord(?:p(?:d|s)|s(?:d|s))|unord(?:p(?:d|s)|s(?:d|s))|xchg(?:|16b|486|8b))|c|ov(?:|(?:n?[abgl]e?|n?[ceosz]|np|p[eo]?)))|w(?:d(?:|e)|tl)|all|dq(?:|e)|omis(?:d|s)|pu(?:_(?:read|write)|id)|qo|rc32|s|vt(?:p(?:d2(?:p(?:i|s)|dq)|i2p(?:d|s)|s2(?:p(?:d|i)|dq))|s(?:d2s(?:i|s)|i2s(?:d|s)|s2s(?:d|i))|t(?:p(?:d2(?:dq|pi)|s2(?:dq|pi))|s(?:d2si|s2si))|dq2p(?:d|s)))|d(?:a(?:a|s)|b|d|ec|iv(?:|p(?:d|s)|s(?:d|s))|mint|o|pp(?:d|s)|q|s|t|w|y|z)|e(?:s(?:|c)|mms|nter|qu|xt(?:|r(?:act(?:f128|i128|ps)|q)))|f(?:a(?:bs|dd(?:|p))|b(?:ld|stp)|c(?:o(?:m(?:|i(?:|p)|p(?:|p))|s)|hs|lex|mov(?:b(?:|e)|n(?:b(?:|e)|e|u)|e|u))|d(?:i(?:v(?:|r(?:|p)|p)|si)|ecstp)|e(?:mms|ni)|i(?:n(?:cstp|it)|s(?:t(?:|p|tp)|ub(?:|r))|add|com(?:|p)|div(?:|r)|ld|mul)|m(?:add(?:2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|132(?:p(?:d|s)|s(?:d|s))|sub(?:2(?:13p(?:d|s)|31p(?:d|s))|132p(?:d|s)))|sub(?:2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|132(?:p(?:d|s)|s(?:d|s))|add(?:2(?:13p(?:d|s)|31p(?:d|s))|132p(?:d|s)))|ul(?:|p))|n(?:m(?:add(?:2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|132(?:p(?:d|s)|s(?:d|s)))|sub(?:2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|132(?:p(?:d|s)|s(?:d|s))))|s(?:t(?:cw|env|sw)|ave)|clex|disi|eni|init|op)|p(?:atan|rem(?:|1)|tan)|r(?:ndint|stor)|s(?:|t(?:|cw|env|p|sw)|ave|cale|etpm|in(?:|cos)|qrt|ub(?:|r(?:|p)|p))|x(?:am|ch|rstor(?:|64)|save(?:|64)|tract)|2xm1|free(?:|p)|ld(?:|l(?:2(?:e|t)|g2|n2)|1|cw|env|pi|z)|tst|ucom(?:|i(?:|p)|p(?:|p))|wait|yl2x(?:|p1))|g(?:ather(?:dp(?:d|s)|qp(?:d|s))|etsec|s)|h(?:addp(?:d|s)|int_nop(?:1(?:|0|1|2|3|4|5|6|7|8|9)|2(?:|0|1|2|3|4|5|6|7|8|9)|3(?:|0|1|2|3|4|5|6|7|8|9)|4(?:|0|1|2|3|4|5|6|7|8|9)|5(?:|0|1|2|3|4|5|6|7|8|9)|6(?:|0|1|2|3)|0|7|8|9)|lt|subp(?:d|s))|i(?:n(?:|c(?:|bin)|s(?:|b|d|ert(?:f128|i128|ps|q)|l|w)|t(?:0(?:1|3)||[13o])|v(?:d|ept|lpg(?:|a)|pcid|vpid))|bts|cebp|div|mul|ret(?:|[df]|q|w))|j(?:|(?:n?[abgl]e?|n?[ceosz]|np|p[eo]?)|cxz|ecxz|mp(?:|e)|rcxz)|k(?:a(?:dd(?:b|d|q|w)|nd(?:n(?:b|d|q|w)|b|d|q|w))|x(?:nor(?:b|d|q|w)|or(?:b|d|q|w))|mov(?:b|d|q|w)|not(?:b|d|q|w)|or(?:b|d|q|test(?:b|d|q|w)|w)|shift(?:l(?:b|d|q|w)|r(?:b|d|q|w))|test(?:b|d|q|w)|unpck(?:bw|dq|wd))|l(?:a(?:hf|r)|d(?:dqu|mxcsr|s)|e(?:a(?:|ve)|s)|f(?:ence|s)|o(?:adall(?:|286)|ck|ds(?:|[bdw]|l|q)|op(?:|[dw]?|n?[ez][dw]?))|s(?:l|s)|[gil]dt|call|gs|jmp|lwpcb|msw|ret(?:|w)|tr|wp(?:ins|val)|zcnt)|m(?:a(?:x(?:p(?:d|s)|s(?:d|s))|skmov(?:p(?:d|s)|dqu|q))|o(?:n(?:itor(?:|x)|tmul)|v(?:|d(?:|q(?:2q|a|u)|dup)|h(?:p(?:d|s)|lps)|l(?:p(?:d|s)|hps)|q(?:|2dq)|s(?:|l(?:|dup)|[bdw]|hdup|q|s|xd)|[sz]x|ap(?:d|s)|be|mskp(?:d|s)|nt(?:p(?:d|s)|s(?:d|s)|dq(?:|a)|i|q)|up(?:d|s)|z))|fence|in(?:p(?:d|s)|s(?:d|s))|psadbw|ul(?:|p(?:d|s)|s(?:d|s)|x)|wait(?:|x))|n(?:e(?:c_ins|g)|o(?:t(?:|1)|ne|p))|o(?:r(?:|p(?:d|s))|ut(?:|s(?:b|d?|l|w)))|p(?:a(?:v(?:g(?:b|usb|w)|eb)|bs(?:b|d|w)|ck(?:ss(?:dw|wb)|us(?:dw|wb))|dd(?:s(?:b|iw|w)|b|d|q|us(?:b|w)|w)|lignr|nd(?:|n)|use)|b(?:lend(?:d|vb|w)|roadcast(?:b|d|q|w))|c(?:lmul(?:hq(?:hqdq|lqdq)|lq(?:hqdq|lqdq)|qdq)|mp(?:e(?:q(?:b|d|q|w)|str(?:i|m))|gt(?:b|d|q|w)|istr(?:i|m))|ommit)|d(?:ep|istib)|e(?:rm(?:2(?:f128|i128)|p(?:d|s)|d|ilp(?:d(?:|var)|s(?:|var))|q)|xt(?:|r(?:b|d|q|w)))|f(?:a(?:cc|dd)|m(?:ax|in|ul)|r(?:cp(?:|it(?:1|2)|v)|sq(?:it1|rt(?:|v)))|2i(?:d|w)|cmp(?:g(?:e|t)|eq)|nacc|pnacc|sub(?:|r))|h(?:add(?:d|sw|w)|minposuw|sub(?:d|sw|w))|i(?:2f(?:d|w)|nsr(?:b|d|q|w))|m(?:a(?:x(?:s(?:b|d|w)|u(?:b|d|w))|chriw|dd(?:ubsw|wd)|gw|skmov(?:d|q))|v(?:gezb|lzb|nzb|zb)|in(?:s(?:b|d|w)|u(?:b|d|w))|ov(?:mskb|sx(?:b(?:d|q|w)|w(?:d|q)|dq)|zx(?:b(?:d|q|w)|w(?:d|q)|dq))|ul(?:h(?:r(?:w(?:a|c)|iw|sw)|uw|w)|l(?:d|w)|dq|udq))|o(?:p(?:|a(?:l|w)|f(?:l|q|w)|[af]d?|cnt)|r)|s(?:r(?:a(?:d|vd|w)|l(?:d(?:|q)|v(?:d|q)|q|w))|adbw|huf(?:b|d|hw|lw|w)|ign(?:b|d|w)|ll(?:d(?:|q)|v(?:d|q)|q|w)|ub(?:s(?:b|iw|w)|b|d|q|us(?:b|w)|w)|wapd)|u(?:npck(?:h(?:bw|dq|qdq|wd)|l(?:bw|dq|qdq|wd))|sh(?:|a(?:l|w)|f(?:l|q|w)|[af]d?))|gather(?:d(?:d|q)|q(?:d|q))|refetch(?:|t(?:0|1|2)|w(?:|t1)|nta)|test|xor)|r(?:c(?:p(?:ps|ss)|l|r)|d(?:m(?:|sr)|p(?:id|kru|mc)|s(?:eed|hr)|fsbase|gsbase|rand|tsc(?:|p))|e(?:p(?:|c|n?[ez]|nc)|s(?:b|d|o|q|t|w|y|z)|t(?:|f(?:|d|w)|n(?:|d|w)|d|w)|x.jmp)|o(?:l(?:|4)|r(?:|4|x)|und(?:p(?:d|s)|s(?:d|s)))|s(?:dc|ldt|m|qrt(?:ps|ss)|ts))|s(?:a(?:l(?:|c)|r(?:|x)|hf)|e(?:g(?:cs|ds|es|fs|gs|ss)|t(?:|1|(?:n?[abgl]e?|n?[ceosz]|np|p[eo]?)))|h(?:a(?:1(?:msg(?:1|2)|nexte|rnds4)|256(?:msg(?:1|2)|rnds2))|l(?:d?|x)|r(?:d?|x)|ufp(?:d|s))|m(?:i(?:|nt(?:|old))|sw)|t(?:[cdi]|ac|gi|mxcsr|os(?:|[bdw]|l|q)|r)|v(?:dc|ldt|ts)|[gil]dt|bb|cas(?:|[bdw]|l|q)|fence|kinit|lwpcb|qrt(?:p(?:d|s)|s(?:d|s))|s|ub(?:|p(?:d|s)|s(?:d|s)|4s)|wapgs|ys(?:e(?:nter|xit)|call|ret))|t(?:z(?:cnt|msk)|1mskc|est(?:|p(?:d|s)|1))|u(?:d(?:2(?:|a|b)|0|1)|comis(?:d|s)|mov|npck(?:hp(?:d|s)|lp(?:d|s)))|v(?:a(?:dd(?:p(?:d|s)|s(?:d|s|ubp(?:d|s)))|es(?:dec(?:|last)|enc(?:|last)|imc|keygenassist)|lign(?:d|q)|nd(?:p(?:d|s)|np(?:d|s)))|b(?:lend(?:p(?:d|s)|mp(?:d|s)|vp(?:d|s))|roadcast(?:f(?:128|32x(?:2|4|8)|64x(?:2|4))|i(?:128|32x(?:2|4|8)|64x(?:2|4))|s(?:d|s)))|c(?:mp(?:g(?:e(?:p(?:d|s)|s(?:d|s)|_o(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|t(?:p(?:d|s)|s(?:d|s)|_o(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))))|l(?:e(?:p(?:d|s)|s(?:d|s)|_o(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|t(?:p(?:d|s)|s(?:d|s)|_o(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))))|n(?:g(?:e(?:p(?:d|s)|s(?:d|s)|_u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|t(?:p(?:d|s)|s(?:d|s)|_u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))))|l(?:e(?:p(?:d|s)|s(?:d|s)|_u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|t(?:p(?:d|s)|s(?:d|s)|_u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))))|eq(?:_(?:o(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))|u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s)|eq(?:_(?:u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))|os(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s))|false(?:p(?:d|s)|s(?:d|s)|_o(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|ord(?:_(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s))|true(?:p(?:d|s)|s(?:d|s)|_u(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s))))|unord(?:_(?:q(?:p(?:d|s)|s(?:d|s))|s(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s)))|om(?:is(?:d|s)|pressp(?:d|s))|vt(?:p(?:d2(?:u(?:dq|qq)|dq|ps|qq)|h2ps|s2(?:p(?:d|h)|u(?:dq|qq)|dq|qq))|s(?:d2(?:s(?:i|s)|usi)|i2s(?:d|s)|s2(?:s(?:d|i)|usi))|t(?:p(?:d2(?:u(?:dq|qq)|dq|qq)|s2(?:u(?:dq|qq)|dq|qq))|s(?:d2(?:si|usi)|s2(?:si|usi)))|u(?:dq2p(?:d|s)|qq2p(?:d|s)|si2s(?:d|s))|dq2p(?:d|s)|qq2p(?:d|s)))|d(?:bpsadbw|iv(?:p(?:d|s)|s(?:d|s))|pp(?:d|s))|e(?:r(?:r|w)|x(?:p(?:2p(?:d|s)|andp(?:d|s))|tract(?:f(?:128|32x(?:4|8)|64x(?:2|4))|i(?:128|32x(?:4|8)|64x(?:2|4))|ps)))|f(?:m(?:add(?:1(?:23(?:p(?:d|s)|s(?:d|s))|32(?:p(?:d|s)|s(?:d|s)))|2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|3(?:12(?:p(?:d|s)|s(?:d|s))|21(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s|ub(?:1(?:23p(?:d|s)|32p(?:d|s))|2(?:13p(?:d|s)|31p(?:d|s))|3(?:12p(?:d|s)|21p(?:d|s))|p(?:d|s))))|sub(?:1(?:23(?:p(?:d|s)|s(?:d|s))|32(?:p(?:d|s)|s(?:d|s)))|2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|3(?:12(?:p(?:d|s)|s(?:d|s))|21(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s)|add(?:1(?:23p(?:d|s)|32p(?:d|s))|2(?:13p(?:d|s)|31p(?:d|s))|3(?:12p(?:d|s)|21p(?:d|s))|p(?:d|s))))|ixupimm(?:p(?:d|s)|s(?:d|s))|nm(?:add(?:1(?:23(?:p(?:d|s)|s(?:d|s))|32(?:p(?:d|s)|s(?:d|s)))|2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|3(?:12(?:p(?:d|s)|s(?:d|s))|21(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s))|sub(?:1(?:23(?:p(?:d|s)|s(?:d|s))|32(?:p(?:d|s)|s(?:d|s)))|2(?:13(?:p(?:d|s)|s(?:d|s))|31(?:p(?:d|s)|s(?:d|s)))|3(?:12(?:p(?:d|s)|s(?:d|s))|21(?:p(?:d|s)|s(?:d|s)))|p(?:d|s)|s(?:d|s)))|pclass(?:p(?:d|s)|s(?:d|s))|rcz(?:p(?:d|s)|s(?:d|s)))|g(?:ather(?:dp(?:d|s)|pf(?:0(?:dp(?:d|s)|qp(?:d|s))|1(?:dp(?:d|s)|qp(?:d|s)))|qp(?:d|s))|et(?:exp(?:p(?:d|s)|s(?:d|s))|mant(?:p(?:d|s)|s(?:d|s))))|h(?:addp(?:d|s)|subp(?:d|s))|m(?:a(?:x(?:p(?:d|s)|s(?:d|s))|skmov(?:p(?:d|s)|dqu))|c(?:all|lear)|l(?:aunch|oad)|p(?:sadbw|tr(?:ld|st))|r(?:e(?:ad|sume)|un)|func|in(?:p(?:d|s)|s(?:d|s))|mcall|ov(?:d(?:|q(?:a(?:|32|64)|u(?:|16|32|64|8))|dup)|h(?:p(?:d|s)|lps)|l(?:p(?:d|s)|hps)|q(?:|q(?:a|u))|s(?:d|hdup|ldup|s)|ap(?:d|s)|mskp(?:d|s)|nt(?:p(?:d|s)|dq(?:|a)|qq)|up(?:d|s))|save|ul(?:p(?:d|s)|s(?:d|s))|write|xo(?:ff|n))|p(?:a(?:bs(?:b|d|q|w)|ck(?:ss(?:dw|wb)|us(?:dw|wb))|dd(?:s(?:b|w)|b|d|q|us(?:b|w)|w)|lignr|nd(?:|n(?:|d|q)|d|q)|vg(?:b|w))|b(?:lend(?:m(?:b|d|q|w)|d|vb|w)|roadcast(?:m(?:b2q|w2d)|b|d|q|w))|c(?:m(?:p(?:e(?:q(?:b|d|q|w)|str(?:i|m))|u(?:b|d|q|w)|b|d|gt(?:b|d|q|w)|istr(?:i|m)|q|w)|ov)|o(?:m(?:u(?:b|d|q|w)|b|d|press(?:d|q)|q|w)|nflict(?:d|q))|lmul(?:hq(?:hqdq|lqdq)|lq(?:hqdq|lqdq)|qdq))|e(?:x(?:pand(?:d|q)|tr(?:b|d|q|w))|rm(?:2(?:f128|i128)|i(?:2(?:p(?:d|s)|b|d|q|w)|lp(?:d|s))|p(?:d|s)|b|d|q|t2(?:p(?:d|s)|b|d|q|w)|w))|h(?:add(?:b(?:d|q|w)|d(?:|q)|u(?:b(?:d|q|w)|w(?:d|q)|dq)|w(?:|d|q)|sw)|minposuw|sub(?:d(?:|q)|w(?:|d)|bw|sw))|m(?:a(?:d(?:d(?:52(?:huq|luq)|ubsw|wd)|cs(?:swd|wd))|x(?:s(?:b|d|q|w)|u(?:b|d|q|w))|cs(?:d(?:q(?:h|l)|d)|s(?:d(?:q(?:h|l)|d)|w(?:d|w))|w(?:d|w))|skmov(?:d|q))|in(?:s(?:b|d|q|w)|u(?:b|d|q|w))|ov(?:d(?:2m|b|w)|m(?:2(?:b|d|q|w)|skb)|q(?:2m|b|d|w)|s(?:d(?:b|w)|q(?:b|d|w)|x(?:b(?:d|q|w)|w(?:d|q)|dq)|wb)|w(?:2m|b)|b2m|us(?:d(?:b|w)|q(?:b|d|w)|wb)|zx(?:b(?:d|q|w)|w(?:d|q)|dq))|ul(?:h(?:rsw|uw|w)|l(?:d|q|w)|dq|tishiftqb|udq))|s(?:h(?:a(?:b|d|q|w)|l(?:b|d|q|w)|uf(?:b|d|hw|lw))|r(?:a(?:v(?:d|q|w)|d|q|w)|l(?:d(?:|q)|v(?:d|q|w)|q|w))|adbw|catter(?:d(?:d|q)|q(?:d|q))|ign(?:b|d|w)|ll(?:d(?:|q)|v(?:d|q|w)|q|w)|ub(?:s(?:b|w)|b|d|q|us(?:b|w)|w))|gather(?:d(?:d|q)|q(?:d|q))|insr(?:b|d|q|w)|lzcnt(?:d|q)|or(?:|d|q)|perm|ro(?:l(?:v(?:d|q)|d|q)|r(?:v(?:d|q)|d|q)|t(?:b|d|q|w))|te(?:rnlog(?:d|q)|st(?:|m(?:b|d|q|w)|nm(?:b|d|q|w)))|unpck(?:h(?:bw|dq|qdq|wd)|l(?:bw|dq|qdq|wd))|xor(?:|d|q))|r(?:ange(?:p(?:d|s)|s(?:d|s))|cp(?:14(?:p(?:d|s)|s(?:d|s))|28(?:p(?:d|s)|s(?:d|s))|ps|ss)|educe(?:p(?:d|s)|s(?:d|s))|ndscale(?:p(?:d|s)|s(?:d|s))|ound(?:p(?:d|s)|s(?:d|s))|sqrt(?:14(?:p(?:d|s)|s(?:d|s))|28(?:p(?:d|s)|s(?:d|s))|ps|ss))|s(?:ca(?:lef(?:p(?:d|s)|s(?:d|s))|tter(?:dp(?:d|s)|pf(?:0(?:dp(?:d|s)|qp(?:d|s))|1(?:dp(?:d|s)|qp(?:d|s)))|qp(?:d|s)))|huf(?:f(?:32x4|64x2)|i(?:32x4|64x2)|p(?:d|s))|qrt(?:p(?:d|s)|s(?:d|s))|tmxcsr|ub(?:p(?:d|s)|s(?:d|s)))|u(?:comis(?:d|s)|npck(?:hp(?:d|s)|lp(?:d|s)))|insert(?:f(?:128|32x(?:4|8)|64x(?:2|4))|i(?:128|32x(?:4|8)|64x(?:2|4))|ps)|ld(?:dqu|mxcsr|qqu)|orp(?:d|s)|testp(?:d|s)|xorp(?:d|s)|zero(?:all|upper))|w(?:r(?:fsbase|gsbase|msr|pkru|shr)|ait|binvd)|x(?:a(?:bort|cquire|dd)|b(?:egin|ts)|c(?:hg|rypt(?:c(?:bc|fb|tr)|ecb|ofb))|r(?:elease|stor(?:|s(?:|64)|64))|s(?:ave(?:|c(?:|64)|s(?:|64)|64|opt(?:|64))|etbv|ha(?:1|256)|tore)|end|getbv|lat(?:|b)|or(?:|p(?:d|s))|test)|zeroupper)/);

CodeMirror.defineMode('asm', () => {
    const grammar = {
        builtin: generatedRegex
    };

    return {
        startState() {
            return {};
        },

        token(stream) {
            if (stream.eatSpace()) {
                return null;
            }

            if (stream.eat(';')) {
                stream.skipToEnd();
                return 'comment';
            }

            // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition
            if (stream.match(/\w+:/)) {
                return 'tag';
            }

            for (const key in grammar) {
                // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition
                if (stream.match(grammar[key as keyof typeof grammar])) {
                    return key;
                }
            }

            stream.match(/\S+/);
            return null;
        }
    };
});

CodeMirror.defineMIME('text/x-asm', 'asm');